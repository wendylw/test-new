const rulesDirPlugin = require('eslint-plugin-rulesdir');
rulesDirPlugin.RULES_DIR = 'scripts/eslint-rules';

// We will progressively remove files from this list
const legacyFiles = [
  'src/ordering/components/Billing/index.js',
  'src/ordering/components/CreateOrderButton/index.js',
  'src/ordering/components/CurrencyNumber/index.js',
  'src/ordering/components/Item.stories.js',
  'src/ordering/components/MessageModal/index.js',
  'src/ordering/components/ProductItem.jsx',
  'src/ordering/containers/App/index.js',
  'src/ordering/containers/Customer/components/AddressChangeModal/index.js',
  'src/ordering/containers/Customer/containers/AddressDetail/index.js',
  'src/ordering/containers/Customer/containers/AddressList/index.js',
  'src/ordering/containers/Customer/containers/ContactDetail/index.js',
  'src/ordering/containers/Customer/containers/CustomerInfo/index.js',
  'src/ordering/containers/Customer/utils.js',
  'src/ordering/containers/Error/index.js',
  'src/ordering/containers/Home/__fixtures__/index.js',
  'src/ordering/containers/Home/components/AlcoholModal/index.js',
  'src/ordering/containers/Home/components/CartListDrawer.jsx',
  'src/ordering/containers/Home/components/CurrentCategoryBar/index.js',
  'src/ordering/containers/Home/components/Footer.jsx',
  'src/ordering/containers/Home/components/OfflineStoreModal/index.js',
  'src/ordering/containers/Home/components/ProductDetailDrawer.jsx',
  'src/ordering/containers/Home/components/ProductList.jsx',
  'src/ordering/containers/Home/components/PromotionsBar/components/PromotionContent.jsx',
  'src/ordering/containers/Home/components/PromotionsBar/components/PromotionDetails.jsx',
  'src/ordering/containers/Home/components/PromotionsBar/index.jsx',
  'src/ordering/containers/Home/components/StoreInfoAside/index.js',
  'src/ordering/containers/Home/components/VariationSelector.jsx',
  'src/ordering/containers/Home/index.js',
  'src/ordering/containers/Home/utils.js',
  'src/ordering/containers/Location/LocationPage.js',
  'src/ordering/containers/Location/map.js',
  'src/ordering/containers/Location/mockResponse.js',
  'src/ordering/containers/LocationAndDate/index.js',
  'src/ordering/containers/order-status/containers/MerchantInfo/index.js',
  'src/ordering/containers/order-status/containers/OrderDetails/index.js',
  'src/ordering/containers/order-status/containers/ReportDriver/constants.js',
  'src/ordering/containers/order-status/containers/ReportDriver/index.js',
  'src/ordering/containers/order-status/containers/ReportDriver/redux/index.js',
  'src/ordering/containers/order-status/containers/ReportDriver/redux/selectors.js',
  'src/ordering/containers/order-status/containers/Sorry/index.js',
  'src/ordering/containers/order-status/containers/ThankYou/__fixtures__/index.js',
  'src/ordering/containers/order-status/containers/ThankYou/components/OrderCancellationReasonsAside/index.js',
  'src/ordering/containers/order-status/containers/ThankYou/components/OrderDelayMessage/index.js',
  'src/ordering/containers/order-status/containers/ThankYou/components/PhoneCopyModal/index.js',
  'src/ordering/containers/order-status/containers/ThankYou/constants.js',
  'src/ordering/containers/order-status/containers/ThankYou/index.js',
  'src/ordering/containers/order-status/containers/ThankYou/redux/index.js',
  'src/ordering/containers/order-status/redux/common.js',
  'src/ordering/containers/order-status/redux/index.js',
  'src/ordering/containers/PageLogin/index.js',
  'src/ordering/containers/payments/components/CreditCard/CreditCardSecureInfo.jsx',
  'src/ordering/containers/payments/components/CreditCard/SaveCardSwitch.jsx',
  'src/ordering/containers/payments/components/Loader/index.js',
  'src/ordering/containers/payments/components/Loader/PaymentLoader.stories.js',
  'src/ordering/containers/payments/components/OrderInfo/index.js',
  'src/ordering/containers/payments/components/PaymentCardBrands/index.js',
  'src/ordering/containers/payments/components/PaymentLogo.jsx',
  'src/ordering/containers/payments/components/RedirectForm/index.js',
  'src/ordering/containers/payments/containers/CreditCard/index.js',
  'src/ordering/containers/payments/containers/OnlineBanking/index.js',
  'src/ordering/containers/payments/containers/OnlineBanking/redux/index.js',
  'src/ordering/containers/payments/containers/OnlineBanking/redux/selectors.js',
  'src/ordering/containers/payments/containers/SavedCards/components/StripeCVV.js',
  'src/ordering/containers/payments/containers/SavedCards/CVV.js',
  'src/ordering/containers/payments/containers/SavedCards/index.js',
  'src/ordering/containers/payments/containers/SavedCards/redux/index.js',
  'src/ordering/containers/payments/containers/SavedCards/redux/selectors.js',
  'src/ordering/containers/payments/containers/Stripe/CheckoutForm.js',
  'src/ordering/containers/payments/containers/Stripe/constants.js',
  'src/ordering/containers/payments/containers/Stripe/ErrorMessage.js',
  'src/ordering/containers/payments/containers/Stripe/Field.js',
  'src/ordering/containers/payments/containers/Stripe/index.js',
  'src/ordering/containers/payments/redux/common/index.js',
  'src/ordering/containers/payments/redux/common/selectors.js',
  'src/ordering/containers/payments/redux/common/thunks/api-info.js',
  'src/ordering/containers/payments/redux/common/thunks/create-order.js',
  'src/ordering/containers/payments/redux/common/thunks/index.js',
  'src/ordering/containers/payments/redux/index.js',
  'src/ordering/containers/payments/utils/index.js',
  'src/ordering/containers/payments/utils/utils.test.js',
  'src/ordering/containers/Promotion/components/PromoList/PromoItem.js',
  'src/ordering/containers/Promotion/components/PromoList/PromoList.js',
  'src/ordering/containers/Promotion/index.js',
  'src/ordering/containers/Promotion/utils.js',
  'src/ordering/containers/Routes.js',
  'src/ordering/containers/StoreList/index.js',
  'src/ordering/index.js',
  'src/ordering/redux/__fixtures__/app.fixture.js',
  'src/ordering/redux/__fixtures__/cart.fixture.js',
  'src/ordering/redux/__fixtures__/common.fixture.js',
  'src/ordering/redux/__fixtures__/home.fixture.js',
  'src/ordering/redux/__fixtures__/thankYou.fixture.js',
  'src/ordering/redux/modules/app.js',
  'src/ordering/redux/modules/appActions.test.js',
  'src/ordering/redux/modules/appReducer.test.js',
  'src/ordering/redux/modules/index.js',
  'src/ordering/redux/modules/locationAndDate.js',
  'src/ordering/redux/modules/promotion.js',
  'src/ordering/redux/store.js',
  'src/ordering/redux/store.test.js',
  'src/ordering/redux/types.js',
  'src/redux/__fixtures__/responseGql.fixture.js',
  'src/redux/__fixtures__/state.fixture.js',
  'src/redux/middlewares/api.js',
  'src/redux/middlewares/apiGql.js',
  'src/redux/middlewares/requestPromise.js',
  'src/redux/modules/entities/businesses.js',
  'src/redux/modules/entities/businesses.test.js',
  'src/redux/modules/entities/categories.js',
  'src/redux/modules/entities/categories.test.js',
  'src/redux/modules/entities/error.js',
  'src/redux/modules/entities/index.js',
  'src/redux/modules/entities/loyaltyHistories.js',
  'src/redux/modules/entities/loyaltyHistories.test.js',
  'src/redux/modules/entities/onlineStores.js',
  'src/redux/modules/entities/onlineStores.test.js',
  'src/redux/modules/entities/orders.js',
  'src/redux/modules/entities/orders.test.js',
  'src/redux/modules/entities/products.js',
  'src/redux/modules/entities/products.test.js',
  'src/redux/modules/entities/stores.js',
  'src/redux/modules/entities/stores.test.js',
  'src/ordering/components/PageProcessingLoader.jsx',
  'src/ordering/containers/order-status/containers/ThankYou/components/SelfPickup.jsx',
  'src/ordering/containers/order-status/containers/ThankYou/utils.js',
  'src/ordering/containers/order-status/redux/api-info.js',
  'src/ordering/containers/order-status/redux/selector.js',
  'src/ordering/containers/order-status/redux/thunks.js',
  'src/ordering/containers/order-status/redux/selector.js',
  'src/common/components/ReCAPTCHA/index.jsx',
  'src/site/qrscan/index.jsx',
  'src/serviceWorker.js',
  'src/setupProxy.js',
  'src/setupTests.js',
  'src/sw-build.js',
  'src/sw-template.js',
];

module.exports = {
  env: {
    browser: true,
  },
  parserOptions: {
    // keep consistent with https://github.com/facebook/create-react-app/blob/master/packages/eslint-config-react-app/index.js
    ecmaVersion: 2018,
    sourceType: 'module',
    ecmaFeatures: {
      jsx: true,
    },
  },
  plugins: ['react', 'rulesdir'],
  overrides: [
    {
      files: 'src/**/*.@(js|jsx|ts|jsx)',
      excludedFiles: legacyFiles,
      extends: ['react-app', 'airbnb', 'prettier'],
      rules: {
        'no-console': [1, { allow: ['error'] }],
        'no-unused-expressions': 'off',
        'react/display-name': ['warn', { ignoreTranspilerName: true }],
        'react/prop-types': [2, { ignore: ['t', 'history'] }],
        'react/button-has-type': [0],
        'import/prefer-default-export': [0],
        'no-nested-ternary': [0],
        'class-methods-use-this': [0],
        'no-debugger': 'warn',
        'jsx-a11y/click-events-have-key-events': 'off',
        'jsx-a11y/no-noninteractive-element-interactions': 'off',
        'no-param-reassign': ['error', { ignorePropertyModificationsFor: ['state'] }],
        'no-unused-vars': 'warn',
        'import/no-named-as-default-member': 'warn',
        'rulesdir/jsx-test-id': ['warn', { ifExist: ['onClick', 'onChange', 'onBlur', 'onFocus'] }],
        'rulesdir/no-data-heap-name': 'error',
      },
    },
    {
      files: legacyFiles,
      extends: ['react-app', 'prettier'],
      rules: {
        'no-unused-expressions': 'off',
        'react/display-name': ['warn', { ignoreTranspilerName: true }],
        'rulesdir/jsx-test-id': ['warn', { ifExist: ['onClick', 'onChange', 'onBlur', 'onFocus'] }],
        'rulesdir/no-data-heap-name': 'error',
      },
    },
  ],
};
